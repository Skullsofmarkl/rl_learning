"""
–§—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º.

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ RL –≤ –∑–∞–¥–∞—á–µ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ –≤–æ–∂–¥–µ–Ω–∏—è.

–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –º–µ—Ç—Ä–∏–∫:
- –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏: —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è, –º–∏–Ω–∏–º—É–º—ã/–º–∞–∫—Å–∏–º—É–º—ã
- –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è: —Å–∫–æ—Ä–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ú–µ—Ç—Ä–∏–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è: –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- –†–µ–π—Ç–∏–Ω–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏: —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º

–§—É–Ω–∫—Ü–∏–∏ –º–æ–¥—É–ª—è:
- calculate_metrics(): –≤—ã—á–∏—Å–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
- calculate_comparison_metrics(): —Å–æ–∑–¥–∞–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- print_metrics_summary(): –≤—ã–≤–æ–¥–∏—Ç —Å–≤–æ–¥–∫—É –º–µ—Ç—Ä–∏–∫ –≤ —á–∏—Ç–∞–µ–º–æ–º –≤–∏–¥–µ
- calculate_ranking(): —Å–æ–∑–¥–∞–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º
- print_rankings(): –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–π—Ç–∏–Ω–≥–∏ –≤ —Ç–∞–±–ª–∏—á–Ω–æ–º –≤–∏–¥–µ

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –¥–ª—è —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤ –æ–±—É—á–µ–Ω–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –æ—Ü–µ–Ω–∫–∏
"""

import numpy as np


def calculate_metrics(episode_rewards, episode_lengths, episode_successes):
    """
    –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ RL.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏,
    –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞:
    
    –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
    - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–∏–∑–æ–¥–æ–≤ –∏ –Ω–∞–≥—Ä–∞–¥
    - –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥, –¥–ª–∏–Ω —ç–ø–∏–∑–æ–¥–æ–≤, —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
    - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (–ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ä–∞–∑–±—Ä–æ—Å–∞)
    - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    
    –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è:
    - –°–∫–æ—Ä–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö –∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —ç–ø–∏–∑–æ–¥–æ–≤)
    - –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏ –Ω–∞–≥—Ä–∞–¥)
    - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–Ω–∞–≥—Ä–∞–¥–∞ –Ω–∞ —à–∞–≥)
    - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —ç–ø–∏–∑–æ–¥–∞—Ö
    
    Args:
        episode_rewards (list): —Å–ø–∏—Å–æ–∫ –Ω–∞–≥—Ä–∞–¥ –∑–∞ –∫–∞–∂–¥—ã–π —ç–ø–∏–∑–æ–¥
        episode_lengths (list): —Å–ø–∏—Å–æ–∫ –¥–ª–∏–Ω —ç–ø–∏–∑–æ–¥–æ–≤ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤)
        episode_successes (list): —Å–ø–∏—Å–æ–∫ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ —ç–ø–∏–∑–æ–¥–æ–≤ (1=—É—Å–ø–µ—Ö, 0=–Ω–µ—É–¥–∞—á–∞)
    
    Returns:
        dict: —Å–ª–æ–≤–∞—Ä—å —Å –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏–ª–∏ None –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
    if not episode_rewards or len(episode_rewards) == 0:
        return None
    
    # ========== –ë–ê–ó–û–í–´–ï –ú–ï–¢–†–ò–ö–ò ==========
    total_episodes = len(episode_rewards)                    # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–∏–∑–æ–¥–æ–≤
    total_reward = np.sum(episode_rewards)                   # –°—É–º–º–∞—Ä–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞
    total_length = np.sum(episode_lengths) if episode_lengths else 0  # –°—É–º–º–∞—Ä–Ω–∞—è –¥–ª–∏–Ω–∞
    
    # –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
    mean_reward = np.mean(episode_rewards)                   # –°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä–∞–¥–∞
    mean_length = np.mean(episode_lengths) if episode_lengths else 0  # –°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞
    mean_success = np.mean(episode_successes) if episode_successes else 0  # –°—Ä–µ–¥–Ω—è—è —É—Å–ø–µ—à–Ω–æ—Å—Ç—å
    
    # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (–ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ä–∞–∑–±—Ä–æ—Å–∞)
    std_reward = np.std(episode_rewards)                     # –†–∞–∑–±—Ä–æ—Å –Ω–∞–≥—Ä–∞–¥
    std_length = np.std(episode_lengths) if episode_lengths else 0  # –†–∞–∑–±—Ä–æ—Å –¥–ª–∏–Ω
    
    # –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    min_reward = np.min(episode_rewards)                     # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞
    max_reward = np.max(episode_rewards)                     # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞
    min_length = np.min(episode_lengths) if episode_lengths else 0  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞
    max_length = np.max(episode_lengths) if episode_lengths else 0  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞
    
    # ========== –ú–ï–¢–†–ò–ö–ò –û–ë–£–ß–ï–ù–ò–Ø ==========
    if len(episode_rewards) >= 20:
        # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —ç–ø–∏–∑–æ–¥–æ–≤ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ç–µ–∫—É—â–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        recent_rewards = episode_rewards[-20:]
        recent_success = episode_successes[-20:] if episode_successes else []
        
        recent_mean_reward = np.mean(recent_rewards)         # –°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä–∞–¥–∞ –≤ –∫–æ–Ω—Ü–µ
        recent_mean_success = np.mean(recent_success) if recent_success else 0  # –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –≤ –∫–æ–Ω—Ü–µ
        
        # –°–∫–æ—Ä–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è: —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —ç–ø–∏–∑–æ–¥—ã
        if len(episode_rewards) >= 40:
            first_20_rewards = episode_rewards[:20]
            first_20_mean = np.mean(first_20_rewards)
            learning_improvement = recent_mean_reward - first_20_mean  # –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ = —É–ª—É—á—à–µ–Ω–∏–µ
        else:
            learning_improvement = 0  # –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    else:
        # –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–ø–∏–∑–æ–¥–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–Ω–¥–æ–≤
        recent_mean_reward = mean_reward
        recent_mean_success = mean_success
        learning_improvement = 0
    
    # ========== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–†–ò–ö–ò ==========
    # –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏ (std/mean)
    # –ú–µ–Ω—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è = –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
    stability = std_reward / (abs(mean_reward) + 1e-8)  # +1e-8 –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 0
    
    # –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: –Ω–∞–≥—Ä–∞–¥–∞ –Ω–∞ —à–∞–≥
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∞–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Ä–µ–º—è
    efficiency = mean_reward / (mean_length + 1e-8)  # +1e-8 –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 0
    
    # –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ —Å–ª–æ–≤–∞—Ä—å
    metrics = {
        # –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
        'total_episodes': total_episodes,
        'total_reward': total_reward,
        'total_length': total_length,
        
        # –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
        'mean_reward': mean_reward,
        'mean_length': mean_length,
        'mean_success': mean_success,
        
        # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
        'std_reward': std_reward,
        'std_length': std_length,
        
        # –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
        'min_reward': min_reward,
        'max_reward': max_reward,
        'min_length': min_length,
        'max_length': max_length,
        
        # –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è
        'recent_mean_reward': recent_mean_reward,        # –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –∫–æ–Ω—Ü–µ
        'recent_mean_success': recent_mean_success,      # –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –≤ –∫–æ–Ω—Ü–µ
        'learning_improvement': learning_improvement,    # –°–∫–æ—Ä–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
        'stability': stability,                          # –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
        'efficiency': efficiency                         # –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–Ω–∞–≥—Ä–∞–¥–∞/—à–∞–≥)
    }
    
    return metrics


def calculate_comparison_metrics(algorithm_metrics):
    """
    –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.
    
    Args:
        algorithm_metrics: —Å–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
    
    Returns:
        dict: —Å–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    """
    comparison_metrics = {}
    
    for algorithm, metrics in algorithm_metrics.items():
        if metrics is None:
            continue
            
        # –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (0-1)
        reward_norm = min(1.0, metrics['mean_reward'] / 20)  # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–≥—Ä–∞–¥–µ
        success_norm = metrics['mean_success']
        stability_norm = 1 / (1 + metrics['stability'])  # –ò–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
        efficiency_norm = min(1.0, metrics['efficiency'] / 0.1)  # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
        
        comparison_metrics[algorithm] = {
            'reward_score': reward_norm,
            'success_score': success_norm,
            'stability_score': stability_norm,
            'efficiency_score': efficiency_norm,
            'overall_score': np.mean([reward_norm, success_norm, stability_norm, efficiency_norm])
        }
    
    return comparison_metrics


def print_metrics_summary(algorithm_metrics):
    """
    –í—ã–≤–æ–¥–∏—Ç —Å–≤–æ–¥–∫—É –º–µ—Ç—Ä–∏–∫ –¥–ª—è –≤—Å–µ—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.
    
    Args:
        algorithm_metrics: —Å–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
    """
    print("\n" + "="*80)
    print("–°–í–û–î–ö–ê –ú–ï–¢–†–ò–ö –ü–û –ê–õ–ì–û–†–ò–¢–ú–ê–ú")
    print("="*80)
    
    for algorithm, metrics in algorithm_metrics.items():
        if metrics is None:
            print(f"\n{algorithm}: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö")
            continue
            
        print(f"\n{algorithm}:")
        print(f"  –≠–ø–∏–∑–æ–¥—ã: {metrics['total_episodes']}")
        print(f"  –°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä–∞–¥–∞: {metrics['mean_reward']:.3f} ¬± {metrics['std_reward']:.3f}")
        print(f"  –°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞: {metrics['mean_length']:.1f} ¬± {metrics['std_length']:.1f}")
        print(f"  –£—Å–ø–µ—à–Ω–æ—Å—Ç—å: {metrics['mean_success']:.2%}")
        print(f"  –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: {metrics['stability']:.3f}")
        print(f"  –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: {metrics['efficiency']:.3f}")
        
        if metrics['learning_improvement'] != 0:
            print(f"  –£–ª—É—á—à–µ–Ω–∏–µ: {metrics['learning_improvement']:+.3f}")
        
        print(f"  –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —ç–ø–∏–∑–æ–¥–æ–≤:")
        print(f"    –ù–∞–≥—Ä–∞–¥–∞: {metrics['recent_mean_reward']:.3f}")
        print(f"    –£—Å–ø–µ—à–Ω–æ—Å—Ç—å: {metrics['recent_mean_success']:.2%}")


def calculate_ranking(comparison_metrics):
    """
    –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º.
    
    Args:
        comparison_metrics: —Å–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    
    Returns:
        dict: —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–π—Ç–∏–Ω–≥–∞–º–∏
    """
    if not comparison_metrics:
        return {}
    
    algorithms = list(comparison_metrics.keys())
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –∫–∞–∂–¥–æ–º—É –∫—Ä–∏—Ç–µ—Ä–∏—é
    rankings = {}
    
    # –ü–æ –æ–±—â–µ–π –æ—Ü–µ–Ω–∫–µ
    overall_scores = [(alg, comparison_metrics[alg]['overall_score']) for alg in algorithms]
    overall_scores.sort(key=lambda x: x[1], reverse=True)
    rankings['overall'] = overall_scores
    
    # –ü–æ –Ω–∞–≥—Ä–∞–¥–µ
    reward_scores = [(alg, comparison_metrics[alg]['reward_score']) for alg in algorithms]
    reward_scores.sort(key=lambda x: x[1], reverse=True)
    rankings['reward'] = reward_scores
    
    # –ü–æ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
    success_scores = [(alg, comparison_metrics[alg]['success_score']) for alg in algorithms]
    success_scores.sort(key=lambda x: x[1], reverse=True)
    rankings['success'] = success_scores
    
    # –ü–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
    stability_scores = [(alg, comparison_metrics[alg]['stability_score']) for alg in algorithms]
    stability_scores.sort(key=lambda x: x[1], reverse=True)
    rankings['stability'] = stability_scores
    
    # –ü–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    efficiency_scores = [(alg, comparison_metrics[alg]['efficiency_score']) for alg in algorithms]
    efficiency_scores.sort(key=lambda x: x[1], reverse=True)
    rankings['efficiency'] = efficiency_scores
    
    return rankings


def print_rankings(rankings):
    """
    –í—ã–≤–æ–¥–∏—Ç —Ä–µ–π—Ç–∏–Ω–≥–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.
    
    Args:
        rankings: —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–π—Ç–∏–Ω–≥–∞–º–∏
    """
    print("\n" + "="*80)
    print("–†–ï–ô–¢–ò–ù–ì–ò –ê–õ–ì–û–†–ò–¢–ú–û–í")
    print("="*80)
    
    for criterion, ranking in rankings.items():
        print(f"\n{criterion.upper()}:")
        for i, (algorithm, score) in enumerate(ranking):
            medal = "ü•á" if i == 0 else "ü•à" if i == 1 else "ü•â" if i == 2 else f"{i+1}."
            print(f"  {medal} {algorithm}: {score:.3f}")
